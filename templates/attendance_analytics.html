{% extends "base.html" %}

{% block title %}Attendance Analytics{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1><i class="fas fa-chart-line"></i> Attendance Analytics</h1>
</div>

<div class="table-container">
    <h2>Attendance Summary</h2>
    
    <div style="margin-bottom: 30px;">
        <canvas id="attendanceChart" height="100"></canvas>
    </div>
    
    <table>
        <thead>
            <tr>
                <th>Course</th>
                <th>Total Sessions</th>
                <th>Sessions Attended</th>
                <th>Attendance Percentage</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for stat in analytics %}
            <tr>
                <td>{{ stat.course_name }}</td>
                <td>{{ stat.total_sessions }}</td>
                <td>{{ stat.attended_sessions }}</td>
                <td>
                    <strong>{{ stat.percentage }}%</strong>
                </td>
                <td>
                    {% if stat.percentage >= 80 %}
                    <span class="status-badge status-active">
                        <i class="fas fa-check-circle"></i> Good
                    </span>
                    {% elif stat.percentage >= 60 %}
                    <span class="status-badge" style="background-color: #fef3c7; color: #92400e;">
                        <i class="fas fa-exclamation-circle"></i> Fair
                    </span>
                    {% else %}
                    <span class="status-badge" style="background-color: #fee2e2; color: #dc2626;">
                        <i class="fas fa-times-circle"></i> Poor
                    </span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    const analyticsData = '{{ analytics|tojson }}';
    document.addEventListener('DOMContentLoaded', function() {
        renderAttendanceChart(analyticsData);
    });
</script>
{% endblock %}